
 
# <p align="center"> MKlon4.0
## <p align="center">Зарядное устройство на модулях ESP32 и SAMD21.
### <p align="center">(реализация конечного автомата в проекте зарядного устройства)
## <p align="center">Проект Arduino.
#### <p align="right">редакция от 11 апреля 2023 года


![](https://github.com/olmoro/MKlon4.0/blob/main/documents/full/img/full_1.png)
![](https://github.com/olmoro/MKlon4.0/blob/main/documents/full/img/full_2.png)
![](https://github.com/olmoro/MKlon4.0/blob/main/documents/full/img/full_3.png)
![](https://github.com/olmoro/MKlon4.0/blob/main/documents/full/img/full_4.png)

### MKlon4.0 - это вариант компоновки проекта MKlon2 с сохранением основных параметров, исключая разве что пользовательский интерфейс, реализованный на дисплее ILI9486 3.5 или 4.0 дюйма с сенсорной панелью. Отличием от аналогичных проектов, реализованных сообществом DIY и напоминающих "блюдо спагетти" из-за переплетающихся проводов будет этажерочная конструкция из трёх плат размером 108х62 мм: дисплей, плата управления и силовая плата. По сравнению с прототипом MKlon2 предполагается более полно использовать преимущества четырехточечного подключения заряжаемой батареи, применяя ноутбучные разъёмы для подключения. Как вариант прибор может быть дополнен выносным пультом управления, дублирующим управление с сенсорной панели дисплея - 5-кнопочная клавиатура, энкодеры, подключения разумного количества датчиков температуры DS18B20 - по беспроводной связи с базовым блоком. Впрочем, подключение может быть и проводным - для этого есть специальный разъём. Предусмотрены также разъемы для подключения логического анализатора к выводам обоих модулей - ESP32 и SAMD21 и сигнальные светодиоды. 

1. [Как это работает](#mklon)




***
## <p align="center"> Как это работает.
В зарядном устройстве пользовательский интерфейс реализован на модуле с ESP32 (ESP), а управление модулем силовой платы производится по последовательному каналу. На ESP обслуживается дисплей, RGB индикатор, зуммер, система контроля питания, система охлаждения, интерфейс драйвера силовой платы, USB, WiFi, BT. В памяти ESP хранятся заводские и пользовательские настройки. Оператору предоставляется возможность выбрать посредством меню требуемый режим работы, задать параметры и запустить. Настройки беспроводной сети позволяют в реальном времени на удаленном компьютере не только наблюдать в виде графиков процесс: напряжение, ток, баланс заряда/разряда, температуру, работу системы охлаждения, но и управлять им. Программное обеспечение ESP построено таким образом, что позволяет даже непрофессиональному программисту реализовать свой собственный алгоритм, воспользовавшись методикой из репозитория FSM.

